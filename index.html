<!doctype html><html lang=en-us><head><meta name=generator content="Hugo 0.111.3"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Home | Checking Out Code Committed Within the Same GitHub Actions Workflow Run</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css></head><body><nav><ul class=menu></ul><hr></nav><p>Suppose we have the following GitHub workflow:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>add_commit</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>outputs</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>commit_hash</span>: <span style=color:#ae81ff>${{ steps.add_commit.outputs.commit_hash }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>add_commit</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>stefanzweifel/git-auto-commit-action@v4</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>commit_message</span>: <span style=color:#ae81ff>Add empty commit</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>commit_options</span>: --<span style=color:#ae81ff>allow-empty</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>skip_dirty_check</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#f92672>deploy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>needs</span>: <span style=color:#ae81ff>add_commit</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      <span style=color:#75715e># act on changes from add_commit job</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e># ...</span>
</span></span></code></pre></div><h2 id=scenarios>Scenarios</h2><h3 id=defaultcheckout>defaultCheckout</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>deploy</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>needs</span>: <span style=color:#ae81ff>add_commit</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span></code></pre></div><h3 id=defaultcheckoutandpull>defaultCheckoutAndPull</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>deploy</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>needs</span>: <span style=color:#ae81ff>add_commit</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>run</span>: <span style=color:#ae81ff>git pull</span>
</span></span></code></pre></div><h3 id=checkoutworkflowref>checkoutWorkflowRef</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>deploy</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>needs</span>: <span style=color:#ae81ff>add_commit</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>ref</span>: <span style=color:#ae81ff>${{ github.ref }}</span>
</span></span></code></pre></div><h3 id=checkoutexact>checkoutExact</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>deploy</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>needs</span>: <span style=color:#ae81ff>add_commit</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>ref</span>: <span style=color:#ae81ff>${{ needs.add_commit.outputs.commit_hash }}</span>
</span></span></code></pre></div><h2 id=test-runs>Test Runs</h2><h3>4/1/23</h3><table><thead><tr><th colspan=2></th><th>ubuntu-22.04</th><th>ubuntu-20.04</th><th>macos-12</th><th>macos-11</th><th>windows-2022</th><th>windows-2019</th></tr></thead><tbody><tr><th colspan=2>Git</th><td>2.40.0</td><td>2.40.0</td><td>2.40.0</td><td>2.40.0</td><td>2.40.0.windows.1</td><td>2.40.0.windows.1</td></tr><tr><th rowspan=2>defaultCheckout</th><th>expected</th><td><code>80d6ae1</code></td><td><code>80d6ae1</code></td><td><code>80d6ae1</code></td><td><code>80d6ae1</code></td><td><code>80d6ae1</code></td><td><code>80d6ae1</code></td></tr><tr><th>actual</th><td><code>80d6ae1</code></td><td><code>80d6ae1</code></td><td><code>80d6ae1</code></td><td><code>80d6ae1</code></td><td><code>80d6ae1</code></td><td><code>80d6ae1</code></td></tr><tr><th rowspan=2>defaultCheckoutAndPull</th><th>expected</th><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td></tr><tr><th>actual</th><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td></tr><tr><th rowspan=2>checkoutWorkflowRef</th><th>expected</th><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td></tr><tr><th>actual</th><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td></tr><tr><th rowspan=2>checkoutExact</th><th>expected</th><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td></tr><tr><th>actual</th><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td><td><code>72532b1</code></td></tr></tbody></table><h3>4/2/23</h3><table><thead><tr><th colspan=2></th><th>ubuntu-22.04</th><th>ubuntu-20.04</th><th>macos-12</th><th>macos-11</th><th>windows-2022</th><th>windows-2019</th></tr></thead><tbody><tr><th colspan=2>Git</th><td>2.40.0</td><td>2.40.0</td><td>2.40.0</td><td>2.40.0</td><td>2.40.0.windows.1</td><td>2.40.0.windows.1</td></tr><tr><th rowspan=2>defaultCheckout</th><th>expected</th><td><code>4c7925f</code></td><td><code>4c7925f</code></td><td><code>4c7925f</code></td><td><code>4c7925f</code></td><td><code>4c7925f</code></td><td><code>4c7925f</code></td></tr><tr><th>actual</th><td><code>4c7925f</code></td><td><code>4c7925f</code></td><td><code>4c7925f</code></td><td><code>4c7925f</code></td><td><code>4c7925f</code></td><td><code>4c7925f</code></td></tr><tr><th rowspan=2>defaultCheckoutAndPull</th><th>expected</th><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td></tr><tr><th>actual</th><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td></tr><tr><th rowspan=2>checkoutWorkflowRef</th><th>expected</th><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td></tr><tr><th>actual</th><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td></tr><tr><th rowspan=2>checkoutExact</th><th>expected</th><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td></tr><tr><th>actual</th><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td><td><code>0f4022a</code></td></tr></tbody></table><ul></ul><footer></footer></body></html>